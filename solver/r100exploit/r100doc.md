# 'r100' 'angr' solution
This doucmumentation will be covering the process taken to form a solution for  the **angr ctf challenge for r100**.

### Analyzing in Ghidra
- To start things off, we opened **Ghidra** so we could **identify and map out functions**. From there we imported the **r100** binary. 
- Then from there, while looking at the **FUN_004007e8** function, we noticed a functioned names **puts** is displaying the output **"Nice!"** or **"Incorrect password!** based off the user's input. This is important we know where we need to go in **memory** to find the correct password which is **0x400849** .

### r100 file
- Next we ran **'file r100'** in our terminal which resulted in the output shown below: 
``` 
r100: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 2.6.24, BuildID[sha1]=0f464824cc8ee321ef9a80a799c70b1b6aec8168, stripped
```

### r100 checksec
- After running 'file', we ran a **checksec** on teh 'r100' file. The ourput is shown below: 
```
RELRO           STACK CANARY      NX            PIE             RPATH      RUNPATH      Symbols         FORTIFY Fortified       Fortifiable     FILE
Partial RELRO   Canary found      NX enabled    No PIE          No RPATH   No RUNPATH   No Symbols        No    0               2               r100
```
## Solution Program
```
  1 # import angr
  2 import angr
  3 
  4 # Establish the Angr Project
  5 target = angr.Project('r100')
  6 
  7 # Specify the desired address which means we have the correct input
  8 desired_adr = 0x400849
  9 
 10 # Specify the address which if it executes means we don't have the correct input
 11 wrong_adr = 0x40085a
 12 
 13 # Establish the entry state
 14 entry_state = target.factory.entry_state(args=["./fairlight"])
 15 
 16 # Establish the simulation
 17 simulation = target.factory.simulation_manager(entry_state)
 18 
 19 # Start the simulation
 20 simulation.explore(find = desired_adr, avoid = wrong_adr)
 21 
 22 solution = simulation.found[0].posix.dumps(0)
 23 # Display solution
 24 print(solution)
```
## The **correct** password
Now after running the **solution program** we see that correct password is a bit long but the password is:
```
Code_Talkers\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00\x00    
```
Now, after running the originial **'r100** program then copy and pasting the **correct password** we got this output:
```
Nice!
```               
